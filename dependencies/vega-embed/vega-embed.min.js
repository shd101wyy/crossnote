!function(e){if("object"==typeof exports&&"undefined"!=typeof module)module.exports=e();else if("function"==typeof define&&define.amd)define([],e);else{("undefined"!=typeof window?window:"undefined"!=typeof global?global:"undefined"!=typeof self?self:this).vegaEmbed=e()}}(function(){return function e(t,n,r){function i(u,a){if(!n[u]){if(!t[u]){var s="function"==typeof require&&require;if(!a&&s)return s(u,!0);if(o)return o(u,!0);var c=new Error("Cannot find module '"+u+"'");throw c.code="MODULE_NOT_FOUND",c}var l=n[u]={exports:{}};t[u][0].call(l.exports,function(e){var n=t[u][1][e];return i(n||e)},l,l.exports,e,t,n,r)}return n[u].exports}for(var o="function"==typeof require&&require,u=0;u<r.length;u++)i(r[u]);return i}({1:[function(e,t,n){var r,i;r=this,i=function(){var e=/^v?(?:\d+)(\.(?:[x*]|\d+)(\.(?:[x*]|\d+)(?:-[\da-z\-]+(?:\.[\da-z\-]+)*)?(?:\+[\da-z\-]+(?:\.[\da-z\-]+)*)?)?)?$/i,t=/-([0-9A-Za-z-.]+)/;function n(e){var t=e.replace(/^v/,"").split("."),n=t.splice(0,2);return n.push(t.join(".")),n}function r(e){return isNaN(Number(e))?e:Number(e)}function i(t){if("string"!=typeof t)throw new TypeError("Invalid argument expected string");if(!e.test(t))throw new Error("Invalid argument not valid semver")}return function(e,o){[e,o].forEach(i);for(var u=n(e),a=n(o),s=0;s<3;s++){var c=parseInt(u[s]||0,10),l=parseInt(a[s]||0,10);if(c>l)return 1;if(l>c)return-1}if([u[2],a[2]].every(t.test.bind(t))){var f=t.exec(u[2])[1].split(".").map(r),h=t.exec(a[2])[1].split(".").map(r);for(s=0;s<Math.max(f.length,h.length);s++){if(void 0===f[s]||"string"==typeof h[s]&&"number"==typeof f[s])return-1;if(void 0===h[s]||"string"==typeof f[s]&&"number"==typeof h[s])return 1;if(f[s]>h[s])return 1;if(h[s]>f[s])return-1}}else if([u[2],a[2]].some(t.test.bind(t)))return t.test(u[2])?-1:1;return 0}},"object"==typeof n?t.exports=i():r.compareVersions=i()},{}],2:[function(e,t,n){var r;r=this,function(e){"use strict";var t="http://www.w3.org/1999/xhtml",n={svg:"http://www.w3.org/2000/svg",xhtml:t,xlink:"http://www.w3.org/1999/xlink",xml:"http://www.w3.org/XML/1998/namespace",xmlns:"http://www.w3.org/2000/xmlns/"},r=function(e){var t=e+="",r=t.indexOf(":");return r>=0&&"xmlns"!==(t=e.slice(0,r))&&(e=e.slice(r+1)),n.hasOwnProperty(t)?{space:n[t],local:e}:e};var i=function(e){var n=r(e);return(n.local?function(e){return function(){return this.ownerDocument.createElementNS(e.space,e.local)}}:function(e){return function(){var n=this.ownerDocument,r=this.namespaceURI;return r===t&&n.documentElement.namespaceURI===t?n.createElement(e):n.createElementNS(r,e)}})(n)},o=0;function u(){return new a}function a(){this._="@"+(++o).toString(36)}a.prototype=u.prototype={constructor:a,get:function(e){for(var t=this._;!(t in e);)if(!(e=e.parentNode))return;return e[t]},set:function(e,t){return e[this._]=t},remove:function(e){return this._ in e&&delete e[this._]},toString:function(){return this._}};var s=function(e){return function(){return this.matches(e)}};if("undefined"!=typeof document){var c=document.documentElement;if(!c.matches){var l=c.webkitMatchesSelector||c.msMatchesSelector||c.mozMatchesSelector||c.oMatchesSelector;s=function(e){return function(){return l.call(this,e)}}}}var f=s,h={};(e.event=null,"undefined"!=typeof document)&&("onmouseenter"in document.documentElement||(h={mouseenter:"mouseover",mouseleave:"mouseout"}));function p(e,t,n){return e=d(e,t,n),function(t){var n=t.relatedTarget;n&&(n===this||8&n.compareDocumentPosition(this))||e.call(this,t)}}function d(t,n,r){return function(i){var o=e.event;e.event=i;try{t.call(this,this.__data__,n,r)}finally{e.event=o}}}function v(e){return function(){var t=this.__on;if(t){for(var n,r=0,i=-1,o=t.length;r<o;++r)n=t[r],e.type&&n.type!==e.type||n.name!==e.name?t[++i]=n:this.removeEventListener(n.type,n.listener,n.capture);++i?t.length=i:delete this.__on}}}function g(e,t,n){var r=h.hasOwnProperty(e.type)?p:d;return function(i,o,u){var a,s=this.__on,c=r(t,o,u);if(s)for(var l=0,f=s.length;l<f;++l)if((a=s[l]).type===e.type&&a.name===e.name)return this.removeEventListener(a.type,a.listener,a.capture),this.addEventListener(a.type,a.listener=c,a.capture=n),void(a.value=t);this.addEventListener(e.type,c,n),a={type:e.type,name:e.name,value:t,listener:c,capture:n},s?s.push(a):this.__on=[a]}}var m=function(){for(var t,n=e.event;t=n.sourceEvent;)n=t;return n},y=function(e,t){var n=e.ownerSVGElement||e;if(n.createSVGPoint){var r=n.createSVGPoint();return r.x=t.clientX,r.y=t.clientY,[(r=r.matrixTransform(e.getScreenCTM().inverse())).x,r.y]}var i=e.getBoundingClientRect();return[t.clientX-i.left-e.clientLeft,t.clientY-i.top-e.clientTop]};function _(){}var w=function(e){return null==e?_:function(){return this.querySelector(e)}};function b(){return[]}var x=function(e){return null==e?b:function(){return this.querySelectorAll(e)}},A=function(e){return new Array(e.length)};function S(e,t){this.ownerDocument=e.ownerDocument,this.namespaceURI=e.namespaceURI,this._next=null,this._parent=e,this.__data__=t}S.prototype={constructor:S,appendChild:function(e){return this._parent.insertBefore(e,this._next)},insertBefore:function(e,t){return this._parent.insertBefore(e,t)},querySelector:function(e){return this._parent.querySelector(e)},querySelectorAll:function(e){return this._parent.querySelectorAll(e)}};var E="$";function N(e,t,n,r,i,o){for(var u,a=0,s=t.length,c=o.length;a<c;++a)(u=t[a])?(u.__data__=o[a],r[a]=u):n[a]=new S(e,o[a]);for(;a<s;++a)(u=t[a])&&(i[a]=u)}function P(e,t,n,r,i,o,u){var a,s,c,l={},f=t.length,h=o.length,p=new Array(f);for(a=0;a<f;++a)(s=t[a])&&(p[a]=c=E+u.call(s,s.__data__,a,t),c in l?i[a]=s:l[c]=s);for(a=0;a<h;++a)(s=l[c=E+u.call(e,o[a],a,o)])?(r[a]=s,s.__data__=o[a],l[c]=null):n[a]=new S(e,o[a]);for(a=0;a<f;++a)(s=t[a])&&l[p[a]]===s&&(i[a]=s)}function O(e,t){return e<t?-1:e>t?1:e>=t?0:NaN}var L=function(e){return e.ownerDocument&&e.ownerDocument.defaultView||e.document&&e||e.defaultView};function M(e,t){return e.style.getPropertyValue(t)||L(e).getComputedStyle(e,null).getPropertyValue(t)}function T(e){return e.trim().split(/^|\s+/)}function j(e){return e.classList||new C(e)}function C(e){this._node=e,this._names=T(e.getAttribute("class")||"")}function V(e,t){for(var n=j(e),r=-1,i=t.length;++r<i;)n.add(t[r])}function q(e,t){for(var n=j(e),r=-1,i=t.length;++r<i;)n.remove(t[r])}C.prototype={add:function(e){this._names.indexOf(e)<0&&(this._names.push(e),this._node.setAttribute("class",this._names.join(" ")))},remove:function(e){var t=this._names.indexOf(e);t>=0&&(this._names.splice(t,1),this._node.setAttribute("class",this._names.join(" ")))},contains:function(e){return this._names.indexOf(e)>=0}};function D(){this.textContent=""}function z(){this.innerHTML=""}function B(){this.nextSibling&&this.parentNode.appendChild(this)}function I(){this.previousSibling&&this.parentNode.insertBefore(this,this.parentNode.firstChild)}function U(){return null}function $(){var e=this.parentNode;e&&e.removeChild(this)}function k(e,t,n){var r=L(e),i=r.CustomEvent;"function"==typeof i?i=new i(t,n):(i=r.document.createEvent("Event"),n?(i.initEvent(t,n.bubbles,n.cancelable),i.detail=n.detail):i.initEvent(t,!1,!1)),e.dispatchEvent(i)}var R=[null];function H(e,t){this._groups=e,this._parents=t}function J(){return new H([[document.documentElement]],R)}H.prototype=J.prototype={constructor:H,select:function(e){"function"!=typeof e&&(e=w(e));for(var t=this._groups,n=t.length,r=new Array(n),i=0;i<n;++i)for(var o,u,a=t[i],s=a.length,c=r[i]=new Array(s),l=0;l<s;++l)(o=a[l])&&(u=e.call(o,o.__data__,l,a))&&("__data__"in o&&(u.__data__=o.__data__),c[l]=u);return new H(r,this._parents)},selectAll:function(e){"function"!=typeof e&&(e=x(e));for(var t=this._groups,n=t.length,r=[],i=[],o=0;o<n;++o)for(var u,a=t[o],s=a.length,c=0;c<s;++c)(u=a[c])&&(r.push(e.call(u,u.__data__,c,a)),i.push(u));return new H(r,i)},filter:function(e){"function"!=typeof e&&(e=f(e));for(var t=this._groups,n=t.length,r=new Array(n),i=0;i<n;++i)for(var o,u=t[i],a=u.length,s=r[i]=[],c=0;c<a;++c)(o=u[c])&&e.call(o,o.__data__,c,u)&&s.push(o);return new H(r,this._parents)},data:function(e,t){if(!e)return d=new Array(this.size()),l=-1,this.each(function(e){d[++l]=e}),d;var n,r=t?P:N,i=this._parents,o=this._groups;"function"!=typeof e&&(n=e,e=function(){return n});for(var u=o.length,a=new Array(u),s=new Array(u),c=new Array(u),l=0;l<u;++l){var f=i[l],h=o[l],p=h.length,d=e.call(f,f&&f.__data__,l,i),v=d.length,g=s[l]=new Array(v),m=a[l]=new Array(v);r(f,h,g,m,c[l]=new Array(p),d,t);for(var y,_,w=0,b=0;w<v;++w)if(y=g[w]){for(w>=b&&(b=w+1);!(_=m[b])&&++b<v;);y._next=_||null}}return(a=new H(a,i))._enter=s,a._exit=c,a},enter:function(){return new H(this._enter||this._groups.map(A),this._parents)},exit:function(){return new H(this._exit||this._groups.map(A),this._parents)},merge:function(e){for(var t=this._groups,n=e._groups,r=t.length,i=n.length,o=Math.min(r,i),u=new Array(r),a=0;a<o;++a)for(var s,c=t[a],l=n[a],f=c.length,h=u[a]=new Array(f),p=0;p<f;++p)(s=c[p]||l[p])&&(h[p]=s);for(;a<r;++a)u[a]=t[a];return new H(u,this._parents)},order:function(){for(var e=this._groups,t=-1,n=e.length;++t<n;)for(var r,i=e[t],o=i.length-1,u=i[o];--o>=0;)(r=i[o])&&(u&&u!==r.nextSibling&&u.parentNode.insertBefore(r,u),u=r);return this},sort:function(e){function t(t,n){return t&&n?e(t.__data__,n.__data__):!t-!n}e||(e=O);for(var n=this._groups,r=n.length,i=new Array(r),o=0;o<r;++o){for(var u,a=n[o],s=a.length,c=i[o]=new Array(s),l=0;l<s;++l)(u=a[l])&&(c[l]=u);c.sort(t)}return new H(i,this._parents).order()},call:function(){var e=arguments[0];return arguments[0]=this,e.apply(null,arguments),this},nodes:function(){var e=new Array(this.size()),t=-1;return this.each(function(){e[++t]=this}),e},node:function(){for(var e=this._groups,t=0,n=e.length;t<n;++t)for(var r=e[t],i=0,o=r.length;i<o;++i){var u=r[i];if(u)return u}return null},size:function(){var e=0;return this.each(function(){++e}),e},empty:function(){return!this.node()},each:function(e){for(var t=this._groups,n=0,r=t.length;n<r;++n)for(var i,o=t[n],u=0,a=o.length;u<a;++u)(i=o[u])&&e.call(i,i.__data__,u,o);return this},attr:function(e,t){var n=r(e);if(arguments.length<2){var i=this.node();return n.local?i.getAttributeNS(n.space,n.local):i.getAttribute(n)}return this.each((null==t?n.local?function(e){return function(){this.removeAttributeNS(e.space,e.local)}}:function(e){return function(){this.removeAttribute(e)}}:"function"==typeof t?n.local?function(e,t){return function(){var n=t.apply(this,arguments);null==n?this.removeAttributeNS(e.space,e.local):this.setAttributeNS(e.space,e.local,n)}}:function(e,t){return function(){var n=t.apply(this,arguments);null==n?this.removeAttribute(e):this.setAttribute(e,n)}}:n.local?function(e,t){return function(){this.setAttributeNS(e.space,e.local,t)}}:function(e,t){return function(){this.setAttribute(e,t)}})(n,t))},style:function(e,t,n){return arguments.length>1?this.each((null==t?function(e){return function(){this.style.removeProperty(e)}}:"function"==typeof t?function(e,t,n){return function(){var r=t.apply(this,arguments);null==r?this.style.removeProperty(e):this.style.setProperty(e,r,n)}}:function(e,t,n){return function(){this.style.setProperty(e,t,n)}})(e,t,null==n?"":n)):M(this.node(),e)},property:function(e,t){return arguments.length>1?this.each((null==t?function(e){return function(){delete this[e]}}:"function"==typeof t?function(e,t){return function(){var n=t.apply(this,arguments);null==n?delete this[e]:this[e]=n}}:function(e,t){return function(){this[e]=t}})(e,t)):this.node()[e]},classed:function(e,t){var n=T(e+"");if(arguments.length<2){for(var r=j(this.node()),i=-1,o=n.length;++i<o;)if(!r.contains(n[i]))return!1;return!0}return this.each(("function"==typeof t?function(e,t){return function(){(t.apply(this,arguments)?V:q)(this,e)}}:t?function(e){return function(){V(this,e)}}:function(e){return function(){q(this,e)}})(n,t))},text:function(e){return arguments.length?this.each(null==e?D:("function"==typeof e?function(e){return function(){var t=e.apply(this,arguments);this.textContent=null==t?"":t}}:function(e){return function(){this.textContent=e}})(e)):this.node().textContent},html:function(e){return arguments.length?this.each(null==e?z:("function"==typeof e?function(e){return function(){var t=e.apply(this,arguments);this.innerHTML=null==t?"":t}}:function(e){return function(){this.innerHTML=e}})(e)):this.node().innerHTML},raise:function(){return this.each(B)},lower:function(){return this.each(I)},append:function(e){var t="function"==typeof e?e:i(e);return this.select(function(){return this.appendChild(t.apply(this,arguments))})},insert:function(e,t){var n="function"==typeof e?e:i(e),r=null==t?U:"function"==typeof t?t:w(t);return this.select(function(){return this.insertBefore(n.apply(this,arguments),r.apply(this,arguments)||null)})},remove:function(){return this.each($)},datum:function(e){return arguments.length?this.property("__data__",e):this.node().__data__},on:function(e,t,n){var r,i,o=function(e){return e.trim().split(/^|\s+/).map(function(e){var t="",n=e.indexOf(".");return n>=0&&(t=e.slice(n+1),e=e.slice(0,n)),{type:e,name:t}})}(e+""),u=o.length;if(!(arguments.length<2)){for(a=t?g:v,null==n&&(n=!1),r=0;r<u;++r)this.each(a(o[r],t,n));return this}var a=this.node().__on;if(a)for(var s,c=0,l=a.length;c<l;++c)for(r=0,s=a[c];r<u;++r)if((i=o[r]).type===s.type&&i.name===s.name)return s.value},dispatch:function(e,t){return this.each(("function"==typeof t?function(e,t){return function(){return k(this,e,t.apply(this,arguments))}}:function(e,t){return function(){return k(this,e,t)}})(e,t))}};e.creator=i,e.local=u,e.matcher=f,e.mouse=function(e){var t=m();return t.changedTouches&&(t=t.changedTouches[0]),y(e,t)},e.namespace=r,e.namespaces=n,e.clientPoint=y,e.select=function(e){return"string"==typeof e?new H([[document.querySelector(e)]],[document.documentElement]):new H([[e]],R)},e.selectAll=function(e){return"string"==typeof e?new H([document.querySelectorAll(e)],[document.documentElement]):new H([null==e?[]:e],R)},e.selection=J,e.selector=w,e.selectorAll=x,e.style=M,e.touch=function(e,t,n){arguments.length<3&&(n=t,t=m().changedTouches);for(var r,i=0,o=t?t.length:0;i<o;++i)if((r=t[i]).identifier===n)return y(e,r);return null},e.touches=function(e,t){null==t&&(t=m().touches);for(var n=0,r=t?t.length:0,i=new Array(r);n<r;++n)i[n]=y(e,t[n]);return i},e.window=L,e.customEvent=function(t,n,r,i){var o=e.event;t.sourceEvent=e.event,e.event=t;try{return n.apply(r,i)}finally{e.event=o}},Object.defineProperty(e,"__esModule",{value:!0})}("object"==typeof n&&void 0!==t?n:r.d3=r.d3||{})},{}],3:[function(e,t,n){"use strict";Object.defineProperty(n,"__esModule",{value:!0}),n.default=function(e){var t=/\/schema\/([\w-]+)\/([\w\.\-]+)\.json$/g.exec(e).slice(1,3);return{library:t[0],version:t[1]}}},{}],4:[function(e,t,n){(function(t){"use strict";Object.defineProperty(n,"__esModule",{value:!0});var r=e("compare-versions"),i=e("d3-selection"),o="undefined"!=typeof window?window.vega:void 0!==t?t.vega:null,u="undefined"!=typeof window?window.vl:void 0!==t?t.vl:null,a=e("vega-schema-url-parser");n.vega=o,n.vl=u;var s=e("./post"),c={vega:"Vega","vega-lite":"Vega-Lite"},l={vega:n.vega.version,"vega-lite":n.vl?n.vl.version:"not available"},f={vega:function(e){return e},"vega-lite":function(e){return n.vl.compile(e).spec}};n.default=function e(t,o,u){try{var h=void 0===(u=u||{}).actions||u.actions,p=u.loader||n.vega.loader(),d=u.renderer||"canvas",v=u.logLevel||n.vega.Warn;if(n.vega.isString(o))return p.load(o).then(function(n){return e(t,JSON.parse(n),u)}).catch(Promise.reject);var g=u.config;if(n.vega.isString(g))return p.load(g).then(function(n){return u.config=JSON.parse(n),e(t,o,u)}).catch(Promise.reject);var m,y=void 0;o.$schema?(y=a.default(o.$schema),u.mode&&u.mode!==y.library&&console.warn("The given visualization spec is written in "+c[y.library]+", but mode argument sets "+c[u.mode]+"."),m=y.library,r(y.version,l[m])>0&&console.warn("The input spec uses "+m+" "+y.version+", but the current version of "+c[m]+" is "+l[m]+".")):m=u.mode||"vega";var _=f[m](o);"vega-lite"===m&&_.$schema&&(y=a.default(_.$schema),r(y.version,l.vega)>0&&console.warn("The compiled spec uses Vega "+y.version+", but current version is "+l.vega+"."));var w=i.select(t).classed("vega-embed",!0).html("");u.onBeforeParse&&(_=u.onBeforeParse(_));var b=n.vega.parse(_,u.config),x=new n.vega.View(b,{loader:p,logLevel:v,renderer:d}).initialize(t);if("vega-lite"!==m&&x.hover(),u&&(u.width&&x.width(u.width),u.height&&x.height(u.height),u.padding&&x.padding(u.padding)),x.run(),!1!==h){var A=w.append("div").attr("class","vega-actions");if(!0===h||!1!==h.export){var S="canvas"===d?"png":"svg";A.append("a").text("Export as "+S.toUpperCase()).attr("href","#").attr("target","_blank").attr("download",(o.name||"vega")+"."+S).on("mousedown",function(){var e=this;x.toImageURL(S).then(function(t){e.href=t}).catch(function(e){throw e}),i.event.preventDefault()})}if(!0!==h&&!1===h.source||A.append("a").text("View Source").attr("href","#").on("click",function(){var e,t,n,r,a,s;e=JSON.stringify(o,null,2),t=u.sourceHeader||"",n=u.sourceFooter||"",r="<html><head>"+t+"</head>' + '<body><pre><code class=\"json\">",a="</code></pre>"+n+"</body></html>",(s=window.open("")).document.write(r+e+a),s.document.title="Vega JSON Source",i.event.preventDefault()}),!0===h||!1!==h.editor){var E=u.editorUrl||"https://vega.github.io/editor/";A.append("a").text("Open in Vega Editor").attr("href","#").on("click",function(){s.post(window,E,{mode:m,spec:JSON.stringify(o,null,2)}),i.event.preventDefault()})}}return Promise.resolve({view:x,spec:o})}catch(e){return Promise.reject(e)}}}).call(this,"undefined"!=typeof global?global:"undefined"!=typeof self?self:"undefined"!=typeof window?window:{})},{"./post":6,"compare-versions":1,"d3-selection":2,"vega-schema-url-parser":3}],5:[function(e,t,n){(function(n){"use strict";var r="undefined"!=typeof window?window.vega:void 0!==n?n.vega:null,i="undefined"!=typeof window?window.vl:void 0!==n?n.vl:null,o=e("./embed"),u=o.default;u.default=o.default,u.vega=r,u.vl=i,t.exports=u}).call(this,"undefined"!=typeof global?global:"undefined"!=typeof self?self:"undefined"!=typeof window?window:{})},{"./embed":4}],6:[function(e,t,n){"use strict";Object.defineProperty(n,"__esModule",{value:!0}),n.post=function(e,t,n){var r=e.open(t),i=250,o=~~(1e4/i);e.addEventListener("message",function t(n){n.source===r&&(o=0,e.removeEventListener("message",t,!1))},!1),setTimeout(function e(){o<=0||(r.postMessage(n,"*"),setTimeout(e,i),o-=1)},i)}},{}]},{},[5])(5)});
